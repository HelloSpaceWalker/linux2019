## Redis sentinel介绍

Redis Sentinel是Redis高可用的实现方案。Sentinel是一个管理多个Redis实例的工具，它可以实现对Redis的监控、通知、自动故障转移。

### Redis Sentinel的主要功能

Sentinel的主要功能包括主节点存活检测、主从运行情况检测、自动故障转移（failover）、主从切换。Redis的Sentinel最小配置是一主一从。
Redis的Sentinel系统可以用来管理多个Redis服务器，该系统可以执行以下四个任务：

* 监控

	Sentinel会不断的检查主服务器和从服务器是否正常运行。

* 通知

	当被监控的某个Redis服务器出现问题，Sentinel通过API脚本向管理员或者其他的应用程序发送通知。

* 自动故障转移

	当主节点不能正常工作时，Sentinel会开始一次自动的故障转移操作，它会将与失效主节点是主从关系的其中一个从节点升级为新的主节点，
	并且将其他的从节点指向新的主节点。

* 配置提供者

	在Redis Sentinel模式下，客户端应用在初始化时连接的是Sentinel节点集合，从中获取主节点的信息。

### Redis Sentinel的工作流程

	Sentinel负责监控集群中的所有主、从Redis，当发现主故障时，Sentinel会在所有的从中选一个成为新的主。
	并且会把其余的从变为新主的从。同时那台有问题的旧主也会变为新主的从，也就是说当旧的主即使恢复时，
	并不会恢复原来的主身份，而是作为新主的一个从。

	在Redis高可用架构中，Sentinel往往不是只有一个，而是有3个或者以上。目的是为了让其更加可靠，毕竟主
	和从切换角色这个过程还是蛮复杂的。

### 环境准备

	准备3台机器，其中每台机器上都有两个角色，分配如下：

主机名 | IP:Port |角色
-------|---------|----
aming01|192.168.222.128:6379|Redis Master
aming02|192.168.222.129:6379|Redis Slave1
aming03|192.168.222.130:6379|Redis Slave2
aming01|192.168.222.128:26379|Sentinel1
aming02|192.168.222.129:26379|Sentinel2
aming03|192.168.222.130:26379|Sentinel3
