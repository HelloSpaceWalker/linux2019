## Redis Cluster介绍

Redis Cluster为Redis官方提供的一种分布式集群解决方案。它支持在线节点增加和减少。
集群中，每个节点为一主下面至少有一个从，这样保证了其高可用。但如果一个节点里面的主和从
都挂掉了，那么整个集群就会出问题。

Redis Cluster采用了分布式系统的分片（分区）的思路，每个节点为一个分片，这样也就意味着
存储的数据是分散在所有分片中的。当增加节点或删除节点时，原存储在某个节点中的数据
会自动再次分配到其他节点。

![](https://github.com/aminglinux/linux2019/blob/master/images/redis_cluster.png?raw=true)

如图，各节点间是相互通信的，通信端口为各节点Redis服务端口+10000，这个端口是固定的，所以注意防火墙设置，
节点之间通过二进制协议通信，这样的目的是减少带宽消耗。

在Redis Cluster中有一个概念slot，我们翻译为槽。Slot数量是固定的，为16384个。这些slot会均匀地分布到各个
节点上。另外Redis的键和值会根据hash算法存储在对应的slot中。简单讲，对于一个键值对，存的时候在哪里是通过
hash算法算出来的，那么取得时候也会算一下，知道值在哪个slot上。根据slot编号再到对应的节点上去取。

Redis Cluster无法保证数据的强一致性，这是因为当数据存储时，只要在主上存好了，就会告诉客户端存好了，
如果等所有从上都同步完再跟客户端确认，那么会有很大的延迟，这个对于客户端来讲是无法容忍的。所以，最终
Redis Cluster只好放弃了数据强一致性，而把性能放在了首位。

## Redis Cluster搭建

### 环境准备




